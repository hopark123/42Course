# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: hopark <hopark@student.42seoul.kr>         +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2021/04/28 18:03:34 by hopark            #+#    #+#              #
#    Updated: 2021/05/09 18:01:47 by hopark           ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

NAME1 = checker
NAME2 = push_swap

CC = gcc
CFLAGS = -Wall -Wextra -Werror
RM = rm
RMFLAGS = -f

SRC_DIR = src
INC_DIR = include
UTIL_DIR = $(SRC_DIR)/util
ENGINE_DIR = $(SRC_DIR)/engine
PUSH_SWAP_DIR = $(SRC_DIR)/push_swap
CHECKER_DIR = $(SRC_DIR)/checker
OBJ_DIR1 = obj1
OBJ_DIR2 = obj2

INCLUDES = $(wildcard $(INC_DIR)/*.h)
CHECKER = $(wildcard $(CHECKER_DIR)/*.c)
ENGINE = $(wildcard $(ENGINE_DIR)/*.c)
PUSH_SWAP = $(wildcard $(PUSH_SWAP_DIR)/*.c)
UTIL = $(wildcard $(UTIL_DIR)/*.c)

vpath %.c \
	$(SRC_DIR) \
	$(ENGINE_DIR) \
	$(PUSH_SWAP_DIR) \
	$(CHECKER_DIR) \
	$(UTIL_DIR) \

SRC1 = \
	$(CHECKER) \
	$(ENGINE) \
	$(UTIL) \

SRC2 = \
	$(PUSH_SWAP) \
	$(ENGINE) \
	$(UTIL) \

OBJ1 = $(addprefix $(OBJ_DIR1)/, $(notdir $(SRC1:.c=.o)))
OBJ2 = $(addprefix $(OBJ_DIR2)/, $(notdir $(SRC2:.c=.o)))
OBJS = $(OBJ1) $(OBJ2) 

all : $(NAME1) $(NAME2)

clean :
	$(RM) $(RMFLAGS) $(OBJS)

fclean : clean
	$(RM) $(RMFLAGS) $(NAME)

re : fclean all

test1 : $(NAME1)
	./checker 2 1 3 4
test2 : $(NAME2)
	ARG="308 69 72 165 163 219 138 190 296 204 398 406 92 126 80 453 337 336 279 158 265 71 141 216 131 389 144 430 403 348 249 455 55 316 54 109 188 307 445 435 275 374 284 150 499 299 202 17 140 124 147 14 8 287 122 132 372 323 370 201 168 400 195 176 143 437 148 221 362 223 429 5 396 433 98 371 261 225 220 329 381 90 258 230 417 198 49 306 298 93 64 184 13 237 229 325 244 215 379 485 203 167 286 157 310 364 247 349 309 155 224 312 472 492 305 428 354 36 290 361 475 94 6 133 154 88 489 324 250 347 9 180 83 346 443 393 401 242 200 156 410 56 431 120 208 26 170 327 436 86 315 390 461 177 384 352 139 175 394 380 319 146 253 40 42 102 53 161 125 199 27 187 182 340 117 62 283 105 1 388 232 73 11 421 288 211 107 496 280 68 259 70 91 345 373 243 110 456 22 318 59 100 276 205 20 302 353 358 239 444 291 121 484 119 366 251 207 19 426 449 413 342 460 331 193 339 407 101 192 300 123 425 382 272 18 454 52 46 256 29 350 238 367 47 179 377 446 61 473 214 452 274 196 228 137 81 277 392 338 427 210 217 386 376 255 213 172 15 97 39 447 368 171 478 476 206 108 218 264 301 23 104 294 442 118 24 343 416 344 332 84 320 471 33 183 106 269 458 333 423 497 263 304 481 136 467 31 67 317 178 359 498 271 43 493 21 369 10 490 169 480 32 321 246 355 25 50 402 113 463 173 115 459 486 257 16 254 79 57 28 378 334 330 3 450 328 76 414 248 397 387 159 231 391 212 58 282 292 409 65 466 127 130 439 227 462 226 311 295 434 468 7 262 185 419 149 488 477 285 241 95 375 487 278 45 500 12 289 303 383 51 166 164 326 103 351 41 399 267 268 404 235 266 77 2 495 424 356 89 457 35 408 129 412 483 197 116 209 313 335 341 112 360 474 395 160 66 440 270 222 385 465 422 363 75 78 85 194 448 74 432 145 438 189 34 415 142 60 153 233 191 48 420 479 44 30 322 111 464 38 470 260 63 135 4 174 293 252 82 37 357 96 273 236 162 181 482 469 418 128 186 152 99 411 281 441 151 297 451 114 314 491 494 405 234 365 134 245 240 87"; ./push_swap $ARG | wc -l
test3 : $(NAME1) $(NAME2)
	./push_swap 12 7 17 9 6 16 18 15 2 11 4 13 8 10 20 14 1 5 19 3  | ./checker 12 7 17 9 6 16 18 15 2 11 4 13 8 10 20 14 1 5 19 3 

$(OBJ_DIR1)/%.o : %.c | $(OBJ_DIR1)
	$(CC) -I $(INC_DIR) -c $< -o $@
	@mkdir -p $(OBJ_DIR1)

$(OBJ_DIR2)/%.o : %.c | $(OBJ_DIR2)
	$(CC) -I $(INC_DIR) -c $< -o $@
	@mkdir -p $(OBJ_DIR2)

$(NAME1) : $(INCLUDES) $(OBJ1)
		$(CC) $(CFLAGS) -o $(NAME1) $(OBJ1)

$(NAME2) : $(INCLUDES) $(OBJ2)
		$(CC) $(CFLAGS) -o $(NAME2) $(OBJ2)

.PHONY: all clean fclean re test\